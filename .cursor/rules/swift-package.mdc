---
description: "Swift Package Manager 개발 가이드라인, 모듈 구조, 빌드 설정, 의존성 관리. Package.swift 수정, 새 타겟 추가, 또는 패키지 구조 작업 시 적용."
globs: ["Package.swift", "Sources/**/*.swift"]
alwaysApply: false
---

# Swift Package Development Guidelines

## 패키지 구조

InnoDI는 Swift Package Manager를 사용하는 멀티 타겟 패키지입니다:

- **InnoDI**: Public API 라이브러리 (`@DIContainer`, `@Provide` 매크로 선언)
- **InnoDIMacros**: 매크로 구현 (swift-syntax 사용)
- **InnoDICore**: 공유 파싱 유틸리티 (매크로와 CLI에서 사용)
- **InnoDICLI**: 정적 분석 CLI 도구

## 타겟 구조

### Public API Library (InnoDI)
- `Sources/InnoDI/`에 위치
- `InnoDIMacros`에 의존
- 공개 API: `@DIContainer`, `@Provide` 매크로 선언, `DIScope` enum

### Macro Implementation (InnoDIMacros)
- `Sources/InnoDIMacros/`에 위치
- `swift-syntax` 패키지 및 `InnoDICore`에 의존
- `@DIContainer`, `@Provide` 매크로 구현

### Shared Parsing (InnoDICore)
- `Sources/InnoDICore/`에 위치
- `swift-syntax` 패키지에 의존
- 매크로와 CLI에서 공유하는 파싱 유틸리티

### CLI Tool (InnoDICLI)
- `Sources/InnoDICLI/`에 위치
- `InnoDICore` 및 `swift-syntax`에 의존
- 정적 분석을 통한 DI 컨테이너 검증

## 빌드 및 테스트

### 빌드
```bash
swift build
```

### 테스트
```bash
# 모든 테스트 실행
swift test

# 코어 파싱 테스트 실행
swift test --filter InnoDICoreTests

# 매크로 확장 테스트 실행
swift test --filter InnoDIMacrosTests
```

### 문서 생성
```bash
swift package generate-documentation --target InnoDI
```

## 코딩 스타일

- Swift API Design Guidelines 준수
- 4칸 들여쓰기 사용
- 공개 API는 `///`로 문서화
- 값 타입 선호, 명시적 타입 사용
- 매크로는 `SwiftSyntaxBuilder`를 사용하여 AST 생성
- 파싱 로직은 `InnoDICore`에 중앙화하여 매크로와 CLI 간 일관성 유지

## 모듈 간 의존성

- `InnoDI` → `InnoDIMacros` (매크로 사용)
- `InnoDIMacros` → `InnoDICore` (파싱 로직 공유)
- `InnoDICLI` → `InnoDICore` (파싱 로직 공유)
- 테스트 타겟은 해당 타겟에 의존

## 공개 API 설계

- 최소한의 공개 API 노출
- 내부 구현 세부사항은 `internal` 또는 `private` 유지
- 매크로는 공개 API의 일부이지만 구현은 내부에 유지

## 버전 관리

- Semantic Versioning 준수
- Breaking changes는 Major 버전 증가
- 새로운 기능은 Minor 버전 증가
- 버그 수정은 Patch 버전 증가

## 플랫폼 지원

패키지는 다음 플랫폼을 지원합니다:
- iOS 26.0+
- macOS 26.0+
- tvOS 26.0+
- watchOS 26.0+
- visionOS 26.0+

## 의존성 관리

- 최소 버전 요구사항 명시
- 가능한 한 최신 버전 사용
- 보안 업데이트 정기적으로 확인
